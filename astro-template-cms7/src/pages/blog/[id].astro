---
import Layout from '../../layouts/Layout.astro'

// 活動レポートのサンプルデータ
const blogPosts = [
  {
    id: 1,
    content:
      '今日は春の植樹活動でした！参加者30名でクヌギとコナラの苗木を100本植樹しました。みんなで協力して作業したので、予定より早く終了。植えた苗木が大きく育つのが楽しみです🌱 #植樹 #春 #森林ボランティア',
    date: '2024-03-20',
    author: '田中 太郎',
    image: '/images/spring-planting.jpg',
    likes: 24,
    comments: 8,
    location: '○○森林',
    weather: '晴れ',
    participants: 30
  },
  {
    id: 2,
    content:
      '森林調査の結果が出ました！昨年植えた苗木の生存率95%達成🎉 平均樹高も15%成長。生物多様性も向上していて、アカゲラやコゲラも増加中。森林が健康に育っている証拠ですね🌳 #調査 #生物多様性 #成果',
    date: '2024-03-10',
    author: '佐藤 花子',
    image: '/images/forest-survey.jpg',
    likes: 31,
    comments: 12,
    location: '△△森林',
    weather: '曇り',
    participants: 15
  }
]

// URLパラメータからIDを取得
const { id } = Astro.params

// idが存在しない場合は404ページにリダイレクト
if (!id) {
  return Astro.redirect('/blog')
}

const postId = parseInt(id)

// 該当する投稿を検索
const post = blogPosts.find((p) => p.id === postId)

// 投稿が見つからない場合は404ページにリダイレクト
if (!post) {
  return Astro.redirect('/blog')
}
---

<Layout title="活動レポート">
  <div class="mx-auto max-w-2xl">
    <!-- 戻るボタン -->
    <div class="mb-6">
      <a href="/blog" class="text-primary-600 hover:text-primary-800 font-semibold">
        <i class="fas fa-arrow-left mr-2"></i>活動レポート一覧に戻る
      </a>
    </div>

    <!-- 投稿記事 -->
    <article class="overflow-hidden rounded-lg bg-white shadow-lg">
      <!-- 投稿ヘッダー -->
      <div class="border-b border-gray-100 p-6">
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <div
              class="bg-primary-600 mr-4 flex h-12 w-12 items-center justify-center rounded-full font-bold text-white"
            >
              {post.author.charAt(0)}
            </div>
            <div>
              <div class="text-lg font-semibold text-gray-800">{post.author}</div>
              <div class="text-base text-gray-500">
                <i class="fas fa-calendar mr-1"></i>
                {new Date(post.date).toLocaleDateString('ja-JP')}
              </div>
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600">
            <i class="fas fa-ellipsis-h"></i>
          </button>
        </div>
      </div>

      <!-- 投稿内容 -->
      <div class="p-6">
        <p class="mb-6 text-lg leading-relaxed text-gray-800">
          {post.content}
        </p>

        <!-- 画像 -->
        <div class="mb-6">
          <img src={post.image} alt="活動写真" class="h-80 w-full rounded-lg object-cover" />
        </div>

        <!-- アクションボタン -->
        <div class="flex items-center justify-between border-t border-gray-100 pt-6">
          <div class="flex items-center space-x-8">
            <button class="flex items-center text-gray-500 transition-colors hover:text-red-500">
              <i class="fas fa-heart mr-2"></i>
              <span>{post.likes}</span>
            </button>
            <button class="flex items-center text-gray-500 transition-colors hover:text-blue-500">
              <i class="fas fa-comment mr-2"></i>
              <span>{post.comments}</span>
            </button>
            <button
              class="hover:text-primary-500 flex items-center text-gray-500 transition-colors"
            >
              <i class="fas fa-share mr-2"></i>
              <span>シェア</span>
            </button>
          </div>
        </div>
      </div>
    </article>

    <!-- コメントセクション -->
    <div class="mt-8 rounded-lg bg-white p-6 shadow-lg">
      <h3 class="mb-4 text-lg font-bold text-gray-800">コメント ({post.comments})</h3>

      <!-- コメント入力 -->
      <div class="mb-6">
        <textarea
          placeholder="コメントを入力してください..."
          class="focus:ring-primary-500 w-full resize-none rounded-lg border border-gray-300 p-3 focus:ring-2 focus:outline-none"
          rows="3"></textarea>
        <div class="mt-2 text-right">
          <button
            class="bg-primary-600 hover:bg-primary-700 rounded px-4 py-2 text-white transition-colors"
          >
            コメントを投稿
          </button>
        </div>
      </div>

      <!-- サンプルコメント -->
      <div class="space-y-4">
        <div class="flex items-start space-x-3">
          <div
            class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-sm font-bold text-white"
          >
            山
          </div>
          <div class="flex-1">
            <div class="mb-1 flex items-center space-x-2">
              <span class="font-semibold text-gray-800">山田 次郎</span>
              <span class="text-base text-gray-500">2024-03-21</span>
            </div>
            <p class="text-gray-700">素晴らしい活動ですね！私も次回参加したいと思います。</p>
          </div>
        </div>

        <div class="flex items-start space-x-3">
          <div
            class="flex h-8 w-8 items-center justify-center rounded-full bg-purple-600 text-sm font-bold text-white"
          >
            佐
          </div>
          <div class="flex-1">
            <div class="mb-1 flex items-center space-x-2">
              <span class="font-semibold text-gray-800">佐藤 花子</span>
              <span class="text-base text-gray-500">2024-03-20</span>
            </div>
            <p class="text-gray-700">お疲れ様でした！苗木の成長が楽しみですね🌱</p>
          </div>
        </div>
      </div>
    </div>

    <!-- 関連レポート -->
    <div class="mt-8">
      <h3 class="mb-4 text-lg font-bold text-gray-800">関連レポート</h3>
      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <div class="overflow-hidden rounded-lg bg-white shadow-md">
          <img
            src="/images/forest-maintenance.jpg"
            alt="森林整備"
            class="h-32 w-full object-cover"
          />
          <div class="p-4">
            <h4 class="mb-2 font-bold text-gray-800">冬の森林整備活動</h4>
            <p class="text-base text-gray-600">寒い中でしたが、枯れ枝の除去と下草刈りを完了！</p>
          </div>
        </div>
        <div class="overflow-hidden rounded-lg bg-white shadow-md">
          <img src="/images/participant1.jpg" alt="新入会員" class="h-32 w-full object-cover" />
          <div class="p-4">
            <h4 class="mb-2 font-bold text-gray-800">新入会員の皆さんへ</h4>
            <p class="text-base text-gray-600">
              今日は安全講習を行いました。安全第一で活動しましょう！
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>
